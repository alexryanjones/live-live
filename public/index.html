<!DOCTYPE html>
<html>
  <head>
    <title>WebSocket Demo</title>
  </head>
  <body>
    <h1 id="counter">0</h1>
    <script>
      const ws = new WebSocket('ws://localhost:8001');
      let count = 0;
      let messageCount = 0;
      let action = []

      ws.onopen = function(event) {
        console.log('Connection is open fuck you!');
      };

      ws.onerror = function(error) {
        console.log('WebSocket Error: ', error);
      };

      ws.onmessage = function(event) {
        const array = JSON.parse(event.data)
        console.log(array);
        if (messageCount < 2) { 
          action.push(array)
          messageCount++;
        } else {
          switch (action[0][11]) {
            case 144:
              count = 1;
              break;
            case 128:
              count = 0;
              break;
              default:
                break;
              }
          document.getElementById('counter').textContent = count;
          action = [];
          messageCount = 0;
        }
      };
    </script>
  </body>
</html>
